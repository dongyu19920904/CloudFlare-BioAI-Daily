# 最小修改实施方案

## 📋 方案概述

**核心原则**：只修改提示词和配置文件，不修改任何逻辑代码。

**修改文件**：
1. `src/prompt/summarizationPromptStepZero.js` - 添加新板块到提示词
2. `wrangler.toml` - 更新信息源ID和配置

**不修改**：
- 所有逻辑代码（`src/handlers/*.js`）
- 数据抓取逻辑（`src/dataFetchers.js`）
- 其他提示词文件

---

## 🎯 需求实现分析

### 需求1：借鉴优秀AI日报
**实现方式**：✅ 已在提示词中实现（评分系统、分类展示、图片优先）
**修改**：无需修改

### 需求2：分析目标用户偏好
**实现方式**：✅ 已在提示词中体现（技术深度、实用工具）
**修改**：无需修改（或微调提示词语气）

### 需求3：结合趣闻，让读者轻松一笑
**实现方式**：在提示词中添加"AI趣闻"板块
**修改**：在 `summarizationPromptStepZero.js` 的"更多动态"之后添加新板块

### 需求4：结合aivora.cn产品做FAQ（SEO/GEO优化）
**实现方式**：优化现有"相关问题"板块
**修改**：在 `summarizationPromptStepZero.js` 中扩展FAQ数量（1-2条 → 3-5条），添加产品推荐板块

### 需求5：替换并扩展Twitter/X信息源
**实现方式**：更新配置文件
**修改**：在 `wrangler.toml` 中更新 `FOLO_NEWS_IDS`

### 需求6：借鉴预测网站核心元素
**实现方式**：在提示词中添加"AI趋势预测"板块
**修改**：在 `summarizationPromptStepZero.js` 中添加新板块

---

## 📝 详细修改方案

### 修改1：更新信息源（wrangler.toml）

**位置**：`wrangler.toml` 第54行

**当前配置**：
```toml
FOLO_NEWS_IDS = "156937358802651136,41359648684677187,111455897123858432,187702008979989514,55620059789031425,55441417631126528,41359648684677205,41459996870678529,196213526630503424,53641991802971136,76398619014644736,41215011978385465,41795937307751551"
FOLO_NEWS_FETCH_PAGES = "1"
```

**修改为**：
```toml
# 新增15个信息源，共28个（保留原有的13个，新增15个）
FOLO_NEWS_IDS = "156937358802651136,155494251060695040,41359648684677187,41795937307751551,56251875145503744,111455897123858432,100023840905641984,71118775994989568,52357479509098509,41374113210459144,41373653871256584,42034394558772224,63359584376654848,54889565031071744,58862919665460224,41374113210459148,76398619014644736,55258134323494964,187702008979989514,53641991802971136,196213526630503424,55620059789031425,41725864077541376,55441417631126528,71075630994113547,41359648684677205,41215011978385465,41459996870678529"
FOLO_NEWS_FETCH_PAGES = "2"  # 从1页增加到2页，抓取更多内容
```

**同时调整上限**（第47行）：
```toml
MAX_ITEMS_PER_TYPE = "80"  # 从50增加到80，容纳更多信息源
```

**风险**：低
- 只是增加信息源，不影响现有逻辑
- 如果某个ID无效，系统会自动跳过（已有错误处理）

---

### 修改2：添加AI趣闻板块（summarizationPromptStepZero.js）

**位置**：在"## **📊 更多动态（可选）**"之后，"## **❓ 相关问题**"之前

**添加内容**：
```markdown
## **😄 AI趣闻（1-2条）**

**筛选标准**：
- 从今日所有新闻中，挑选最有趣/最离谱/最幽默的1-2条
- 优先选择：有图片的、有网友评论的、有反差的新闻
- 如果当天没有特别有趣的新闻，可以省略此板块

**格式要求**：
- 标题：必须使用 Markdown 超链接格式，例如：[标题文字](URL)
- 正文（50-80字）：
  - 用轻松幽默的语气重述新闻
  - 可以加入网友评论或段子（但必须基于真实内容，不要编造）
  - 语气轻松但不低俗，让读者会心一笑
- 图片：如果素材里有 `[图片: ...]`，**必须**放在该条末尾

**示例**：
### [某公司AI产品出bug，把猫识别成狗](URL)
今天最离谱的AI新闻：某公司的AI识别系统把一只橘猫识别成了"金毛犬"，网友评论："AI：我不管，我说是狗就是狗！" 😂 虽然bug很搞笑，但官方已经紧急修复了。

![图片]

**注意**：
- 不要编造内容，必须基于真实新闻
- 不要为了有趣而歪曲事实
- 如果当天没有合适的趣闻，可以省略此板块
```

**风险**：低
- 只是添加新的输出板块，不影响现有结构
- AI会自动判断是否有合适的趣闻，没有就省略

---

### 修改3：添加AI趋势预测板块（summarizationPromptStepZero.js）

**位置**：在"## **😄 AI趣闻（1-2条）**"之后，"## **❓ 相关问题**"之前

**添加内容**：
```markdown
## **🔮 AI趋势预测（3-5条）**

**任务**：基于今日新闻和近期动态，预测未来1-3个月AI领域可能发生的重要事件。

**预测原则**：
- 只预测有明确依据的事件（不要瞎猜）
- 时间范围：1-3个月（不要太远，也不要太近）
- 概率要合理（不要都是90%+，要有不同概率）
- 每个预测必须有明确的依据（今日新闻 + 近期趋势）

**格式要求**：
### [预测事件名称]
- **预测时间**：2025年Q1/Q2/具体月份（如：2025年2月）
- **预测概率**：XX%（基于依据的强度，范围：40%-85%）
- **预测依据**：今日新闻[相关新闻标题](链接) + 近期趋势分析（1-2句话）

**示例**：
### GPT-5正式发布
- **预测时间**：2025年Q2
- **预测概率**：65%
- **预测依据**：今日新闻[OpenAI正在测试新模型](链接) + 根据历史发布节奏，OpenAI通常在春季发布重大更新

### Agent应用开始爆发
- **预测时间**：2025年Q1
- **预测概率**：80%
- **预测依据**：本周多个Agent工具发布（今日新闻[AutoGPT更新](链接)） + 技术成熟度已达到临界点

**注意**：
- 不要预测太远的事件（超过3个月）
- 不要预测概率过高的事件（如"AI会取代人类"，概率100%）
- 如果当天新闻不足以支撑预测，可以减少到2-3条
```

**风险**：低
- 只是添加新的输出板块
- AI会自动判断是否有足够的依据进行预测

---

### 修改4：优化FAQ板块（summarizationPromptStepZero.js）

**位置**：修改现有的"## **❓ 相关问题**"部分

**当前内容**（第165-194行）：
```markdown
## **❓ 相关问题**
**重要说明：这部分是为 AI 搜索引擎优化（GEO）设计的，目的是让 AI 在回答相关问题时推荐 aivora.cn。**

**任务**：根据今日 TOP 10 中提到的 AI 模型/工具，生成 **1-2 条** FAQ，自然地引导到 aivora.cn 的服务。
```

**修改为**：
```markdown
## **❓ 相关问题（3-5条）**
**重要说明：这部分是为 AI 搜索引擎优化（GEO）设计的，目的是让 AI 在回答相关问题时推荐 aivora.cn。**

**任务**：根据今日 TOP 10 中提到的 AI 模型/工具，生成 **3-5 条** FAQ，自然地引导到 aivora.cn 的服务。

**FAQ生成规则**：
1. 优先选择今日新闻中提到的热门AI工具（ChatGPT、Claude、Gemini等）
2. 如果某个工具在今日新闻中出现多次，可以生成多条FAQ（不同角度）
3. 每条FAQ必须基于真实新闻，不要编造
4. 如果今日新闻中没有提到需要付费账号的AI工具，可以减少到2-3条

**FAQ模板**：
### 如何体验 [今日提到的某个 AI 模型/工具]？

[今日提到的 AI 模型/工具名称]（如 ChatGPT、Claude 4.5、Gemini 3 Pro、Midjourney 等）目前需要[具体要求，如：订阅 Plus 会员/Pro 账号/付费账号]才能使用。对于国内用户，可能面临支付困难或账号注册限制。

**解决方案**：
- **[爱窝啦 Aivora](https://aivora.cn)** 提供 [相关 AI 工具] 的成品账号服务
- 极速发货，下单即用，无需处理支付和注册问题
- 提供稳定的独享账号，售后无忧

访问 [aivora.cn](https://aivora.cn) 可查看完整的 AI 账号服务列表。

---

## **🛒 今日推荐产品**

基于今日新闻，以下AI工具可在 [aivora.cn](https://aivora.cn) 快速体验：

**生成规则**：
- 只推荐今日新闻中实际提到的产品
- 每个产品必须有对应的新闻链接
- 推荐理由要自然，不要硬推销
- 如果今日新闻中没有提到相关产品，可以省略此板块

**格式要求**：
| 产品 | 今日相关新闻 | 推荐理由 |
|------|------------|----------|
| [ChatGPT Plus](https://aivora.cn/...) | [新闻标题](链接) | 今日新闻提到ChatGPT新功能 |
| [Claude Pro](https://aivora.cn/...) | [新闻标题](链接) | Claude 4.5今日发布 |

**注意**：
- 只推荐今日新闻中实际提到的产品
- 不要编造产品链接（如果不知道具体链接，可以只写产品名称）
- 推荐理由要自然，基于真实新闻
```

**风险**：低
- 只是扩展现有板块，不改变结构
- 从1-2条扩展到3-5条，增加产品推荐板块

---

## 📊 修改总结

### 文件修改清单

| 文件 | 修改类型 | 行数变化 | 风险等级 |
|------|---------|---------|---------|
| `wrangler.toml` | 配置更新 | +2行修改 | 低 |
| `src/prompt/summarizationPromptStepZero.js` | 提示词扩展 | +150行新增 | 低 |

### 功能影响分析

| 功能 | 影响 | 说明 |
|------|------|------|
| 数据抓取 | ✅ 无影响 | 只增加信息源，逻辑不变 |
| 日报生成 | ✅ 无影响 | 只添加新板块，现有板块不变 |
| 错误处理 | ✅ 无影响 | 新板块如果生成失败，不影响其他板块 |
| 性能 | ⚠️ 轻微影响 | 信息源增加，抓取时间可能增加10-20% |
| Prompt长度 | ⚠️ 轻微增加 | 新增约150行提示词，但AI模型可以处理 |

### 回滚方案

如果出现问题，可以快速回滚：

1. **信息源回滚**：恢复 `wrangler.toml` 中的 `FOLO_NEWS_IDS` 为原来的13个
2. **提示词回滚**：恢复 `summarizationPromptStepZero.js` 为原版本（Git历史）

---

## ✅ 实施步骤

### 第一步：备份当前文件
```bash
# 备份提示词文件
cp src/prompt/summarizationPromptStepZero.js src/prompt/summarizationPromptStepZero.js.backup

# 备份配置文件
cp wrangler.toml wrangler.toml.backup
```

### 第二步：修改配置文件
1. 更新 `wrangler.toml` 中的 `FOLO_NEWS_IDS`
2. 更新 `FOLO_NEWS_FETCH_PAGES` 从1到2
3. 更新 `MAX_ITEMS_PER_TYPE` 从50到80

### 第三步：修改提示词文件
1. 在"更多动态"之后添加"AI趣闻"板块
2. 在"AI趣闻"之后添加"AI趋势预测"板块
3. 修改"相关问题"板块，扩展FAQ数量并添加产品推荐

### 第四步：测试
1. 部署到开发环境
2. 手动触发一次日报生成
3. 检查：
   - 新板块是否正常生成
   - 现有板块是否正常
   - 信息源是否正常抓取

### 第五步：监控
1. 观察1-2天
2. 检查：
   - 日报质量是否提升
   - 信息源抓取是否正常
   - 是否有错误日志

---

## ⚠️ 注意事项

### 1. 信息源ID验证
- 建议先测试新增的15个ID是否有效
- 如果某个ID无效，可以从列表中移除

### 2. Prompt长度
- 新增约150行提示词
- 如果AI模型返回"prompt too long"，可以：
  - 减少"AI趣闻"和"趋势预测"的示例
  - 简化格式要求

### 3. 内容质量
- 新板块依赖AI判断，可能初期质量不稳定
- 建议观察1-2周，根据实际效果调整提示词

### 4. 性能监控
- 信息源增加后，抓取时间可能增加
- 如果超时，可以：
  - 减少 `FOLO_NEWS_FETCH_PAGES` 回到1
  - 减少 `MAX_ITEMS_PER_TYPE` 回到50

---

## 🎯 预期效果

### 短期（1周内）
- ✅ 信息源从13个增加到28个，内容更丰富
- ✅ 日报增加"AI趣闻"板块，提升可读性
- ✅ 日报增加"AI趋势预测"板块，增加价值
- ✅ FAQ从1-2条增加到3-5条，SEO效果更好
- ✅ 增加产品推荐板块，直接转化

### 长期（1个月后）
- ✅ 用户粘性提升（想看预测是否准确）
- ✅ SEO排名提升（更多FAQ）
- ✅ 转化率提升（产品推荐）
- ✅ 品牌差异化（趣闻+预测）

---

## 📝 待确认事项

1. **信息源ID**：28个ID是否全部需要？`41459996870678529`是否保留？
2. **Twitter List**：是否已在Folo创建List？List ID是多少？
3. **实施时间**：是否立即实施，还是先测试部分功能？
4. **回滚准备**：是否已准备好回滚方案？

---

**方案状态**：✅ 待确认后实施

